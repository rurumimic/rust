# Guessing Game

- book: [guessing game](https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html)
- src
   - std::[prelude](https://doc.rust-lang.org/std/prelude/index.html)

## Start

```bash
cargo new guessing_game
     Created binary (application) `guessing_game` package
```

write [main.rs](src/main.rs) and run:

```rs
use std::io;

fn main() {
    println!("Guess the number!!!");
    println!("Please input your guess.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");

    println!("You guessed: {guess}");
}
```

```bash
cargo run
   Compiling guessing_game v0.1.0 (…/src/guessing_game)
    Finished dev [unoptimized + debuginfo] target(s) in 0.75s
     Running `target/debug/guessing_game`
```

```bash
Guess the number!
Please input your guess.
7
You guessed: 7
```

### Dependencies

- crates: [rand](https://crates.io/crates/rand)

```toml
[dependencies]
rand = "0.8.5"
```

- `0.8.5`
- `^0.8.5`
- `0.8.5` ≤ version ≤ `0.9.0`

#### Build

```bash
cargo build
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on build directory
   Compiling libc v0.2.126
   Compiling cfg-if v1.0.0
   Compiling ppv-lite86 v0.2.16
   Compiling getrandom v0.2.7
   Compiling rand_core v0.6.3
   Compiling rand_chacha v0.3.1
   Compiling rand v0.8.5
   Compiling guessing_game v0.1.0 (…/src/guessing_game)
    Finished dev [unoptimized + debuginfo] target(s) in 11.65s
```

repeat:

```bash
cargo build
    Finished dev [unoptimized + debuginfo] target(s) in 0.03s
```

tiny change of `main.rs`:

```rs
// println!("Guess the number!");
println!("Guess the number!!!");
```

and build:

```bash
cargo build
   Compiling guessing_game v0.1.0 (…/src/guessing_game)
    Finished dev [unoptimized + debuginfo] target(s) in 0.51s
```

#### Cargo.lock

```bash
head Cargo.lock
```

```toml
# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 3

[[package]]
name = "cfg-if"
version = "1.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd"
```

#### Random Number

```rs
let secret_number = rand::thread_rng().gen_range(1..=100);

println!("The secret number is: {secret_number}");
```

```bash
cargo run

Guess the number!!!
The secret number is: 29
Please input your guess.
7
You guessed: 7
```

### Comparing

```rs
use std::cmp::Ordering;

match guess.cmp(&secret_number) {
  Ordering::Less => println!("Too small!"),
  Ordering::Greater => println!("Too big!"),
  Ordering::Equal => println!("You win!"),
}
```

```bash
cargo build

   Compiling guessing_game v0.1.0 (…/src/guessing_game)
error[E0308]: mismatched types
  --> src/main.rs:21:21
   |
21 |     match guess.cmp(&secret_number) {
   |                     ^^^^^^^^^^^^^^ expected struct `String`, found integer
   |
   = note: expected reference `&String`
              found reference `&{integer}`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `guessing_game` due to previous error
```

update:

```rs
let guess: u32 = guess.trim().parse().expect("Please type a number!");
```

loop:

```rs
loop {
// --snip-- 
}
```

and run:

```bash
Guess the number!!!
The secret number is: 8
Please input your guess.
4
You guessed: 4
Too small!
Please input your guess.
11
You guessed: 11
Too big!
Please input your guess.
8
You guessed: 8
You win!
Please input your guess.
quit
thread 'main' panicked at 'Please type a number!: ParseIntError { kind: InvalidDigit }', src/main.rs:21:47
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

loop break:

```rs
match guess.cmp(&secret_number) {
  Ordering::Less => println!("Too small!"),
  Ordering::Greater => println!("Too big!"),
  Ordering::Equal => {
    println!("You win!");
    break;
  }
}
```

#### Error Handling

```rs
 let guess: u32 = match guess.trim().parse() {
  Ok(num) => num,
  Err(_) => continue,
};
```

### Run

```bash
cargo run

Guess the number!!!
The secret number is: 93
Please input your guess.
10
You guessed: 10
Too small!
Please input your guess.
100
You guessed: 100
Too big!
Please input your guess.
93
You guessed: 93
You win!
```

`src/main.rs`:

```bash
use rand::Rng;
use std::cmp::Ordering;
use std::io;

fn main() {
    println!("Guess the number!!!");

    let secret_number = rand::thread_rng().gen_range(1..=100);

    println!("The secret number is: {secret_number}");

    loop {
        println!("Please input your guess.");

        let mut guess = String::new();

        io::stdin()
            .read_line(&mut guess)
            .expect("Failed to read line");

        let guess: u32 = guess.trim().parse() {
          Ok(num) => num;
          Err(_) => continue;
        }

        println!("You guessed: {guess}");

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
}
```

---

## Test

go to [testing](../testing/README.md):

```rs
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    #[should_panic]
    fn greater_than_100() {
        Guess::new(200);
    }
}
```

